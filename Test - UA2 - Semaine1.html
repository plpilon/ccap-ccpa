<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="https://drive.google.com/uc?export=download&id=1i7FOimukyvfL_7VixD26O7PHzSzuSPbj">

  <title>Test de vitesse de frappe, 3 essais, meilleur score</title>
  <style>
  :root{
    /* CCAP intranet look */
    --brand:#A4262C;          /* rouge Canada approx */
    --brand-dark:#7F1D22;
    --brand-soft:#FCE8EA;

    --bg:#F3F4F6;
    --surface:#FFFFFF;
    --surface-2:#FAFAFA;

    --text:#1F2937;
    --muted:#6B7280;

    --border:#D1D5DB;
    --border-2:#E5E7EB;

    --focus: rgba(164, 38, 44, .25);

    --good:#0F766E;
    --warn:#B45309;
    --bad:#B91C1C;

    --radius:14px;
  }

  html,body{height:100%}
  body{
    margin:0;
    font-family: "Segoe UI", system-ui, -apple-system, Roboto, Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height:1.35;
  }
body{
  margin:0;
  font-family: "Segoe UI", system-ui, -apple-system, Roboto, Arial, sans-serif;
  color: var(--text);
  line-height:1.35;

  /* Dégradé diagonal rouge pâle -> bleu pâle, avec un centre plus clair */
  background:
    radial-gradient(900px 700px at 50% 35%, rgba(255,255,255,.92) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(135deg, #f2b7b7 0%, #f6e9e9 35%, #e9f0fb 65%, #bcd2f5 100%);
  background-attachment: fixed;
}

  /* Top intranet bar */
  .ccap-topbar{
    background: var(--brand);
    color:#fff;
    height:72px;
    display:flex;
    align-items:center;
    box-shadow: 0 2px 0 rgba(0,0,0,.08);
  }
  .ccap-topbar .inner{
    max-width: 1100px;
    width:100%;
    margin: 0 auto;
    padding: 0 16px;
    display:flex;
    align-items:center;
    gap:14px;
  }
  .ccap-mark{
    width:36px;
    height:36px;
    border-radius:8px;
    background: rgba(255,255,255,.12);
    display:grid;
    place-items:center;
    flex:0 0 auto;
  }
  .ccap-title{
    font-size: 22px;
    font-weight:700;
    letter-spacing:.2px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .ccap-actions{
    margin-left:auto;
    display:flex;
    gap:14px;
    align-items:center;
    font-size:14px;
    opacity:.95;
  }
  .ccap-actions a{
    color:#fff;
    text-decoration:none;
    border-bottom: 1px solid rgba(255,255,255,.35);
  }
  .ccap-actions a:hover{
    border-bottom-color: rgba(255,255,255,.75);
  }

  /* Page wrapper */
  .wrap{
    max-width: 1100px;
    margin: 0 auto;
    padding: 18px 16px 48px;
  }

  .header{
    display:flex;
    gap:12px;
    align-items:flex-start;
    justify-content:space-between;
    flex-wrap:wrap;
    margin-bottom:14px;
  }
  .title{
    font-size:18px;
    font-weight:700;
    margin:0;
  }
  .note{
    color:var(--muted);
    font-size:13px;
    margin-top:6px;
  }

  .pill{
    display:inline-flex;
    gap:8px;
    align-items:center;
    border:1px solid var(--border);
    background: var(--surface);
    border-radius:999px;
    padding:8px 12px;
    color:var(--muted);
    font-size:12px;
    white-space:nowrap;
  }
  .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace}

  .grid{
    display:grid;
    grid-template-columns: 1.1fr .9fr;
    gap:14px;
  }
  @media (max-width: 900px){
    .grid{grid-template-columns:1fr}
  }

  .card{
    border:1px solid var(--border);
    background: var(--surface);
    border-radius: var(--radius);
    padding:16px;
    box-shadow: 0 10px 22px rgba(0,0,0,.06);
  }
  .card h2{
    margin:0 0 12px 0;
    font-size:13px;
    color:var(--muted);
    font-weight:700;
    letter-spacing:.04em;
    text-transform:uppercase;
  }

  .row{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:10px;
  }

  .field label{
    display:block;
    font-size:12px;
    color:var(--muted);
    margin:0 0 6px 0;
  }
  .field input, .field select, textarea{
    width:100%;
    box-sizing:border-box;
    padding:10px 10px;
    border-radius:12px;
    border:1px solid var(--border);
    background: var(--surface-2);
    color:var(--text);
    outline:none;
  }
  .field input:focus, textarea:focus{
    border-color: var(--brand);
    box-shadow: 0 0 0 4px var(--focus);
    background: #fff;
  }

  textarea{
    min-height:160px;
    resize:vertical;
    font-size:14px;
    line-height:1.45;
  }

  .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
  button{
    border:1px solid transparent;
    background: var(--brand);
    color:#fff;
    padding:10px 12px;
    border-radius:12px;
    cursor:pointer;
    font-weight:700;
  }
  button:hover{ background: var(--brand-dark); }
  button:disabled{ cursor:not-allowed; opacity:.55; }

  .ghost{
    background: #fff;
    color: var(--brand);
    border-color: var(--brand);
  }
  .ghost:hover{
    background: var(--brand-soft);
  }

  .danger{
    background: #fff;
    color: var(--bad);
    border:1px solid var(--bad);
  }
  .danger:hover{ background: #FEE2E2; }

  .kpis{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:10px;
  }
  @media (max-width: 900px){
    .kpis{grid-template-columns: repeat(2, 1fr)}
  }
  .kpi{
    border:1px solid var(--border-2);
    background: #fff;
    border-radius:12px;
    padding:10px;
  }
  .kpi .k{font-size:12px; color:var(--muted); margin-bottom:6px}
  .kpi .v{font-size:18px; font-weight:800; color: var(--text)}

  .target{
    border:1px solid var(--border);
    background: #fff;
    border-radius:12px;
    padding:12px;
    font-size:14px;
    user-select:none;
    -webkit-user-select:none;
  }
  .target small{
    display:block;
    color:var(--muted);
    margin-bottom:6px;
    font-size:12px;
  }

  .status{
    margin-top:10px;
    padding:10px 12px;
    border-radius:12px;
    border:1px solid var(--border);
    background: #fff;
    color:var(--muted);
    font-size:13px;
    white-space:pre-wrap;
  }

  .ok{color:var(--good)}
  .warn{color:var(--warn)}
  .bad{color:var(--bad)}

  .hr{height:1px; background: var(--border-2); margin:12px 0}

  .stepcard{display:none;}
  .stepcard.active{display:block;}

  a{color: var(--brand);}
  a:hover{color: var(--brand-dark);}
  </style>
</head>
<body>
  <div class="ccap-topbar">
  <div class="inner">
    <div class="ccap-mark" aria-hidden="true">
<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="-0.804 -0.527 310 314">
  <image href="data:image/png;base64,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" width="310" height="314" x="-0.804" y="-0.527" transform="matrix(1, 0, 0, 1, -1.1368683772161603e-13, 0)"/>
</svg>
    </div>
    <div class="ccap-title">Conseil canadien de l’administration publique</div>
    <div class="ccap-actions">
     <!-- <a href="#" onclick="return false;">Modifier</a>
      <a href="#" onclick="return false;">Suivi</a>
      <a href="#" onclick="return false;">Accès aux sites</a> -->
    </div>
  </div>
</div>
<div class="wrap">
    <div class="header">
      <div>
        <h1 class="title">Évaluation des compétences en technologies d'affaires</h1>
        <div class="note">3 étapes, 50 minutes.</div>
      </div>
      <div class="pill">
        <span>Étape</span>
        <strong id="pillStep">1</strong>
        <span class="mono" id="pillToken" title="Token étudiant"></span>
      </div>
    </div>

    <!-- STEP 1: TYPING TEST -->
    <div class="stepcard card active" id="step1">
      <h2>Étape 1, Test de frappe</h2>

      <div class="grid">
        <div class="card">
          <h2>Identité</h2>
          <div class="row">
            <div class="field">
              <label>Prénom</label>
              <input id="firstName" autocomplete="given-name" />
            </div>
            <div class="field">
              <label>Nom</label>
              <input id="lastName" autocomplete="family-name" />
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <div class="field">
              <label>Numéro étudiant ou courriel</label>
              <input id="studentId" autocomplete="username" />
            </div>
         </div>
          <div class="hr"></div>

          <div class="kpis">
            <div class="kpi">
              <div class="k">Essai</div>
              <div class="v" id="kAttempt">0 / 3</div>
            </div>
            <div class="kpi">
              <div class="k">Temps restant à l'essai (secondes))</div>
              <div class="v" id="kAttemptTime">60</div>
            </div>
            <div class="kpi">
              <div class="k">Temps restant à l'étape (secondes)</div>
              <div class="v" id="kGlobalTime">300</div>
            </div>
            <div class="kpi">
              <div class="k">Meilleur Mots par minute</div>
              <div class="v" id="kBest">0.0</div>
            </div>
          </div>

          <div class="btns">
            <button id="btnStart">Commencer</button>
            <button id="btnFinish" class="ghost" disabled>Terminer l’essai</button>
            <button id="btnNext" class="ghost" disabled>Essai suivant</button>
            <button id="btnForceSubmit" class="danger" disabled>Soumettre maintenant</button>
          </div>

          <div class="status" id="statusBox">Prêt. Clique sur Commencer.</div>

          <div class="note">
            Règle auto: soumission au plus tôt entre 3 essais complétés ou 5 minutes écoulées depuis Commencer.
          </div>
        </div>

        <div class="card">
          <h2>Texte à recopier</h2>
          <div class="target" id="targetBox">
            <small id="targetMeta">Texte 1 sur 3</small>
            <div id="targetText"></div>
          </div>

          <div class="hr"></div>

          <h2>Zone de frappe</h2>
          <textarea id="typingInput" placeholder="Tape ici quand l’essai est en cours" disabled></textarea>

          <div class="note">
            Conseils: garde un rythme stable, vise la précision. Les corrections (Backspace) sont comptées.
          </div>
        </div>
      </div>
    </div>

   <!-- STEP 2 -->
<div class="stepcard card" id="step2">
  <h2>Étape 2</h2>

  <div class="status" id="step2Status">
    Token: <span class="mono" id="tokenStep2"></span>
    <div class="hr"></div>
    Temps restant: <span class="mono" id="step2Countdown">1 200</span> secondes
    <div class="hr"></div>
    <a id="step2DocLink" href="ETAPE2_DOCUMENT_A_CORRIGER.docx" download>Télécharger le document Word à corriger</a>
  </div>

  <div class="card" style="margin-top:12px">
    <h2>Remise du fichier</h2>
    <div class="field">
      <label>Sélectionne ton fichier .docx corrigé</label>
      <input id="step2File" type="file" accept=".docx" />
    </div>
    <div class="btns">
      <button id="btnUploadStep2">Soumettre mon fichier</button>
      <button id="btnToStep3" class="ghost" disabled>Aller à l’étape 3</button>
    </div>
    <div class="status" id="step2UploadStatus">Quand tu soumets, l’étape 3 sera débloquée.</div>
  </div>

  <div class="btns" style="margin-top:12px">
    <button class="ghost" id="btnBackToStep1">Retour à l’étape 1</button>
  </div>
</div>



    <!-- STEP 3: PLACEHOLDER -->
    <div class="stepcard card" id="step3">
      <h2>Étape 3</h2>
      <div class="status">
        Token détecté: <span class="mono" id="tokenStep3"></span>
        <div class="hr"></div>
        Mets ici le contenu de ton étape 3.
      </div>
      <div class="btns">
        <button class="ghost" id="btnBackToStep2">Retour à l’étape 2</button>
      </div>
    </div>

    <div class="note" style="margin-top:14px">
      Faites tout simplement de votre mieux. Ça va aller.
    </div>
  </div>

<script>
/* =========================
   CONFIG
========================= */
const MAX_ATTEMPTS = 3;
const ATTEMPT_DURATION_SEC = 60;
const GLOBAL_LIMIT_SEC = 5 * 60;
const KEEP_BEST_BY = "netwpm_then_accuracy"; // netWpm desc, accuracy desc

// Endpoint Google Apps Script (Web App) pour capturer les résultats
// Laisse vide "" si tu ne veux pas d’envoi.
const ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbxma1DUGVpepCZcwWRViILwftO1d8W_dEAwdX-tsIduxGrt_98jUOSUzrMKl061tLUsxw/exec"; // ex: https://script.google.com/macros/s/XXXXX/exec

// Navigation étapes (dans le même fichier)
const THIS_FILE = location.pathname.split("/").pop() || "ccap_placement.html";

/* =========================
   TEXTS (3)
   Tu peux remplacer par tes propres textes
========================= */
const TEXTS = [
  "Dans un milieu de travail, la qualité des données dépend autant des outils que des habitudes. Un bon fichier, c’est un fichier clair, cohérent, et facile à reprendre par quelqu’un d’autre. Tu n’écris pas seulement pour toi, tu écris pour l’équipe.",
  "La technologie peut accélérer une tâche, mais elle peut aussi amplifier une erreur. Avant d’automatiser, il faut comprendre le problème, valider les entrées, et vérifier les résultats. Une minute de vérification peut éviter une journée de reprise.",
  "Un message professionnel doit être simple et précis. Explique le contexte, dis ce que tu proposes, et indique ce que tu attends de l’autre personne. Si tu peux, ajoute une échéance. La clarté réduit les allers retours et aide tout le monde."
];

const STEP2_LIMIT_SEC = 20 * 60;

let step2StartMs = null;
let step2TickId = null;
let step2Timeouts = [];

function clearStep2Timer(){
  step2Timeouts.forEach(id => clearTimeout(id));
  step2Timeouts = [];
  if (step2TickId) clearInterval(step2TickId);
  step2TickId = null;
}

function startStep2Timer(){
  clearStep2Timer();
  step2StartMs = Date.now();

  // alertes exactes
  step2Timeouts.push(setTimeout(() => {
    if (state.step === 2) alert("Il reste 2 minutes.");
  }, (STEP2_LIMIT_SEC - 120) * 1000));

  step2Timeouts.push(setTimeout(() => {
    if (state.step === 2) alert("Il reste 1 minute.");
  }, (STEP2_LIMIT_SEC - 60) * 1000));

  step2Timeouts.push(setTimeout(() => {
    if (state.step === 2) {
      alert("Temps écoulé. Soumets immédiatement ton fichier.");
      const st = document.getElementById("step2UploadStatus");
      if (st) st.textContent = "Temps écoulé. Soumets immédiatement ton fichier.";
    }
  }, STEP2_LIMIT_SEC * 1000));

  // countdown visible
  step2TickId = setInterval(() => {
    const elapsed = Math.floor((Date.now() - step2StartMs) / 1000);
    const remaining = Math.max(0, STEP2_LIMIT_SEC - elapsed);
    const el = document.getElementById("step2Countdown");
    if (el) el.textContent = String(remaining);
    if (remaining <= 0) clearStep2Timer();
  }, 250);
}

/* =========================
   STATE
========================= */
let state = {
  token: "",
  step: 1,
  globalStartMs: null,
  globalTimerId: null,

  attemptActive: false,
  attemptStartMs: null,
  attemptTickId: null,

  attempts: [],
  attemptsCompleted: 0,
  focusLost: 0,
  backspaces: 0,

  isSubmitted: false,
  currentTextIndex: 0
};

/* =========================
   HELPERS
========================= */
function qs(name){
  const u = new URL(location.href);
  return u.searchParams.get(name);
}
function setUrl(step, token){
  const u = new URL(location.href);
  u.searchParams.set("step", String(step));
  u.searchParams.set("token", token);
  history.replaceState({}, "", u.toString());
}
function showStep(step){
  document.querySelectorAll(".stepcard").forEach(el => el.classList.remove("active"));
  document.getElementById("step" + step).classList.add("active");
  document.getElementById("pillStep").textContent = String(step);
  const pillTok = document.getElementById("pillToken");
  pillTok.textContent = tokenShort(state.token);
}
function tokenShort(t){
  if (!t) return "";
  return t.slice(0, 8);
}
function genToken(){
  if (crypto && crypto.randomUUID) return crypto.randomUUID();
  // fallback
  const bytes = new Uint8Array(16);
  (crypto || window.msCrypto).getRandomValues(bytes);
  return [...bytes].map(b => b.toString(16).padStart(2,"0")).join("");
}
function clamp(n, a, b){ return Math.min(b, Math.max(a, n)); }
function round1(x){ return Math.round(x * 10) / 10; }

function setStatus(msg, cls){
  const el = document.getElementById("statusBox");
  el.classList.remove("ok","warn","bad");
  if (cls) el.classList.add(cls);
  el.textContent = msg;
}

function getElapsedSec(startMs){
  return Math.max(0, Math.floor((Date.now() - startMs) / 1000));
}

function bestAttempt(){
  if (state.attempts.length === 0) return null;
  return state.attempts.slice().sort((a,b)=>{
    if (b.netWpm !== a.netWpm) return b.netWpm - a.netWpm;
    return b.accuracyPct - a.accuracyPct;
  })[0];
}

function computeMetrics(targetText, typedText, durationSec){
  const totalTyped = typedText.length;

  let correctChars = 0;
  let errors = 0;

  const n = Math.max(targetText.length, typedText.length);
  for (let i = 0; i < n; i++){
    const t = targetText[i] ?? "";
    const c = typedText[i] ?? "";
    if (c === "") continue;
    if (c === t) correctChars++;
    else errors++;
  }

  const minutes = durationSec / 60;
  const grossWpm = minutes > 0 ? (totalTyped / 5) / minutes : 0;
  const netWpm = Math.max(0, grossWpm - (errors / minutes));
  const accuracyPct = totalTyped > 0 ? (correctChars / totalTyped) * 100 : 0;

  return {
    grossWpm: round1(grossWpm),
    netWpm: round1(netWpm),
    accuracyPct: round1(accuracyPct),
    errors,
    correctChars,
    totalTyped,
    durationSec
  };
}

/* =========================
   UI: TEXT ROTATION
========================= */
function setTargetText(index){
  state.currentTextIndex = index;
  const meta = document.getElementById("targetMeta");
  const text = document.getElementById("targetText");

  meta.textContent = `Texte ${index + 1} sur 3`;
  text.textContent = TEXTS[index];
}

/* =========================
   TIMERS
========================= */
function startGlobalTimer(){
  state.globalStartMs = Date.now();
  state.globalTimerId = setInterval(()=>{
    const elapsed = getElapsedSec(state.globalStartMs);
    const remaining = clamp(GLOBAL_LIMIT_SEC - elapsed, 0, GLOBAL_LIMIT_SEC);
    document.getElementById("kGlobalTime").textContent = String(remaining);

    if (elapsed >= GLOBAL_LIMIT_SEC){
      stopAttemptIfRunning(true);
      autoSubmit("time_limit");
    }
  }, 200);
}

function stopGlobalTimer(){
  if (state.globalTimerId) clearInterval(state.globalTimerId);
  state.globalTimerId = null;
}

function startAttempt(){
  if (state.attemptActive) return;
  if (state.attemptsCompleted >= MAX_ATTEMPTS) return;

  // rotate text by attempt number: attempt 1 -> text1, attempt2 -> text2, attempt3 -> text3
  setTargetText(state.attemptsCompleted % 3);

  state.attemptActive = true;
  state.attemptStartMs = Date.now();
  document.getElementById("typingInput").disabled = false;
  document.getElementById("typingInput").value = "";
  document.getElementById("typingInput").focus();

  document.getElementById("btnFinish").disabled = false;
  document.getElementById("btnForceSubmit").disabled = false;
  document.getElementById("btnNext").disabled = true;

  setStatus(`Essai ${state.attemptsCompleted + 1} en cours.`, "warn");

  // tick every 100ms for countdown
  state.attemptTickId = setInterval(()=>{
    const elapsed = getElapsedSec(state.attemptStartMs);
    const remaining = clamp(ATTEMPT_DURATION_SEC - elapsed, 0, ATTEMPT_DURATION_SEC);
    document.getElementById("kAttemptTime").textContent = String(remaining);
    if (elapsed >= ATTEMPT_DURATION_SEC){
      finishAttempt("time_up");
    }
  }, 100);
}

function stopAttemptIfRunning(forceFinish){
  if (!state.attemptActive) return;
  if (forceFinish) finishAttempt("forced_by_global");
  else {
    clearInterval(state.attemptTickId);
    state.attemptTickId = null;
    state.attemptActive = false;
    document.getElementById("typingInput").disabled = true;
  }
}

function finishAttempt(reason){
  if (!state.attemptActive) return;

  clearInterval(state.attemptTickId);
  state.attemptTickId = null;

  const attemptEndMs = Date.now();
  const actualDuration = clamp(Math.floor((attemptEndMs - state.attemptStartMs)/1000), 1, ATTEMPT_DURATION_SEC);

  const target = TEXTS[state.currentTextIndex];
  const typed = document.getElementById("typingInput").value;

  const metrics = computeMetrics(target, typed, actualDuration);

  state.attemptsCompleted++;
  state.attempts.push({
    attemptNo: state.attemptsCompleted,
    textNo: state.currentTextIndex + 1,
    reason,
    startedAt: new Date(state.attemptStartMs).toISOString(),
    endedAt: new Date(attemptEndMs).toISOString(),
    backspaces: state.backspaces,
    ...metrics
  });

  // reset backspace count per attempt (optionnel)
  state.backspaces = 0;

  state.attemptActive = false;
  document.getElementById("typingInput").disabled = true;
  document.getElementById("btnFinish").disabled = true;

  // UI
  document.getElementById("kAttempt").textContent = `${state.attemptsCompleted} / ${MAX_ATTEMPTS}`;
  const best = bestAttempt();
  document.getElementById("kBest").textContent = best ? String(best.netWpm.toFixed(1)) : "0.0";

  setStatus(
    `Essai ${state.attemptsCompleted} terminé.\nNet WPM: ${metrics.netWpm.toFixed(1)}\nPrécision: ${metrics.accuracyPct.toFixed(1)}%\nErreurs: ${metrics.errors}\nDurée: ${metrics.durationSec}s`,
    "ok"
  );

  // Next action
  if (state.attemptsCompleted >= MAX_ATTEMPTS){
    document.getElementById("btnNext").disabled = true;
    autoSubmit("attempt_limit");
  } else {
    document.getElementById("btnNext").disabled = false;
  }
}

/* =========================
   SUBMIT
========================= */
function buildPayload(reason){
  const best = bestAttempt();

  return {
    token: state.token,
    step: 1,
    reason,
    studentId: document.getElementById("studentId").value.trim(),
    firstName: document.getElementById("firstName").value.trim(),
    lastName: document.getElementById("lastName").value.trim(),

    attemptsCompleted: state.attemptsCompleted,
    attempts: state.attempts,
    best: best,

    focusLost: state.focusLost,
    totalTimeSec: state.globalStartMs ? getElapsedSec(state.globalStartMs) : null,
    userAgent: navigator.userAgent
  };
}

async function autoSubmit(reason){
  if (state.isSubmitted) return;
  state.isSubmitted = true;

  stopAttemptIfRunning(false);
  stopGlobalTimer();

  const payload = buildPayload(reason);

  // Always proceed to step 2, even if endpoint fails
  let submitOk = false;
  let submitMsg = "";

  if (ENDPOINT_URL){
    try{
      await fetch(ENDPOINT_URL, {
  method: "POST",
  mode: "no-cors",
  headers: {"Content-Type":"application/json"},
  body: JSON.stringify(payload),
  keepalive: true
});

// Avec no-cors, le navigateur ne laisse pas lire la réponse.
// On considère que l'envoi est parti, et on continue vers l’étape 2.
submitOk = true;
submitMsg = "Résultats envoyés (enregistrement dans Sheets).";
         } catch(err){
      submitMsg = "Envoi échoué, passage quand même à l’étape 2.";
    }
  } else {
    submitMsg = "Aucun endpoint configuré, pas d’enregistrement serveur.";
  }

  const b = payload.best
    ? `Meilleur score conservé.\nNet WPM: ${payload.best.netWpm.toFixed(1)}\nPrécision: ${payload.best.accuracyPct.toFixed(1)}%\nErreurs: ${payload.best.errors}`
    : "Aucun essai complété.";

  setStatus(`${b}\n${submitMsg}\nRedirection vers l’étape 2...`, submitOk ? "ok" : "warn");

  // persist identity locally so the same token suit l'étudiant
  persistIdentity();

  // go step 2
  navigateToStep(2);
}

function persistIdentity(){
  const identity = {
    token: state.token,
    firstName: document.getElementById("firstName").value.trim(),
    lastName: document.getElementById("lastName").value.trim(),
    studentId: document.getElementById("studentId").value.trim(),
  };
  localStorage.setItem("typing_test_identity_v1", JSON.stringify(identity));
}

function loadIdentity(){
  try{
    const raw = localStorage.getItem("typing_test_identity_v1");
    if (!raw) return null;
    return JSON.parse(raw);
  } catch {
    return null;
  }
}

/* =========================
   NAV
========================= */
function navigateToStep(step){
  state.step = step;
  setUrl(step, state.token);
  renderByStep(step);
}

function renderByStep(step){
  showStep(step);

if (step === 2){
  document.getElementById("tokenStep2").textContent = state.token;
  startStep2Timer();
} else {
  clearStep2Timer();
}
  if (step === 3){
    document.getElementById("tokenStep3").textContent = state.token;
  }
}
function readFileAsBase64(file){
  return new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.onload = () => {
      const result = String(reader.result || "");
      const comma = result.indexOf(",");
      resolve(comma >= 0 ? result.slice(comma + 1) : result);
    };
    reader.onerror = () => reject(reader.error || new Error("FileReader error"));
    reader.readAsDataURL(file);
  });
}

console.log("Step2 upload click");

async function submitStep2File(){
  const fileInput = document.getElementById("step2File");
  const statusEl = document.getElementById("step2UploadStatus");

  if (!ENDPOINT_URL){
    statusEl.textContent = "ENDPOINT_URL n’est pas configuré.";
    return;
  }

  if (!fileInput || !fileInput.files || fileInput.files.length === 0){
    statusEl.textContent = "Choisis un fichier .docx avant de soumettre.";
    return;
  }

  const file = fileInput.files[0];
  if (!file.name.toLowerCase().endsWith(".docx")){
    statusEl.textContent = "Format invalide. Soumets un .docx.";
    return;
  }

  statusEl.textContent = "Envoi du fichier en cours...";

  try {
    const b64 = await readFileAsBase64(file);

    const payload = {
      token: state.token,
      step: 2,
      reason: "step2_upload",
      studentId: document.getElementById("studentId").value.trim(),
      firstName: document.getElementById("firstName").value.trim(),
      lastName: document.getElementById("lastName").value.trim(),

      // tu peux aussi renvoyer le meilleur score de l'étape 1 si tu veux
      best: bestAttempt(),
      attemptsCompleted: state.attemptsCompleted,
      attempts: state.attempts,
      focusLost: state.focusLost,
      totalTimeSec: state.globalStartMs ? getElapsedSec(state.globalStartMs) : null,
      userAgent: navigator.userAgent,

      file: {
        name: file.name,
        mimeType: file.type || "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
        base64: b64
      }
    };

    await fetch(ENDPOINT_URL, {
  method: "POST",
  mode: "no-cors",
  headers: { "Content-Type": "text/plain;charset=UTF-8" },
  body: JSON.stringify(payload)
});

// no-cors: on ne peut pas lire la réponse, mais la requête part.
statusEl.textContent = "Soumission envoyée. Étape 3 débloquée.";
const bTo3 = document.getElementById("btnToStep3");
if (bTo3) bTo3.disabled = false;
clearStep2Timer();

  } 
  catch (err){
    statusEl.textContent = "Erreur lors de la soumission. Réessaie.";
  }
}

/* =========================
   INIT
========================= */
function init(){
  // token from URL or localStorage or new
  const urlToken = qs("token");
  const urlStep = parseInt(qs("step") || "1", 10);

  const cached = loadIdentity();
  state.token = urlToken || (cached && cached.token) || genToken();

  // Set pill token
  document.getElementById("pillToken").textContent = tokenShort(state.token);

  // Track focus lost
  window.addEventListener("blur", ()=>{ state.focusLost++; });

  // Backspace count
  const typingInput = document.getElementById("typingInput");
  typingInput.addEventListener("keydown", (e)=>{
    if (e.key === "Backspace") state.backspaces++;
    // block paste shortcuts
    if ((e.ctrlKey || e.metaKey) && (e.key.toLowerCase() === "v")) {
      e.preventDefault();
      return false;
    }
  });
  typingInput.addEventListener("paste", (e)=>{
    e.preventDefault();
    return false;
  });

  // Load identity fields if present
  if (cached){
    document.getElementById("firstName").value = cached.firstName || "";
    document.getElementById("lastName").value = cached.lastName || "";
    document.getElementById("studentId").value = cached.studentId || "";
  }

  // Set initial text
  setTargetText(0);

  // Buttons
  document.getElementById("btnStart").addEventListener("click", ()=>{
    if (state.globalStartMs) return;

    // minimal identity check
    const sid = document.getElementById("studentId").value.trim();
    if (!sid){
      setStatus("Ajoute au moins un numéro étudiant ou un courriel, puis recommence.", "bad");
      return;
    }

    document.getElementById("btnStart").disabled = true;
    document.getElementById("btnForceSubmit").disabled = false;

    // initialize kpis
    document.getElementById("kAttempt").textContent = `0 / ${MAX_ATTEMPTS}`;
    document.getElementById("kAttemptTime").textContent = String(ATTEMPT_DURATION_SEC);
    document.getElementById("kGlobalTime").textContent = String(GLOBAL_LIMIT_SEC);

    startGlobalTimer();
    startAttempt();
  });

  document.getElementById("btnFinish").addEventListener("click", ()=>{
    finishAttempt("manual_finish");
  });

  document.getElementById("btnNext").addEventListener("click", ()=>{
    if (state.attemptsCompleted >= MAX_ATTEMPTS) return;
    document.getElementById("typingInput").value = "";
    document.getElementById("kAttemptTime").textContent = String(ATTEMPT_DURATION_SEC);
    startAttempt();
  });

  document.getElementById("btnForceSubmit").addEventListener("click", ()=>{
    stopAttemptIfRunning(true);
    autoSubmit("manual_submit");
  });

  // Step navigation buttons
const bTo3 = document.getElementById("btnToStep3");
if (bTo3) bTo3.addEventListener("click", ()=> navigateToStep(3));

const bBack1 = document.getElementById("btnBackToStep1");
if (bBack1) bBack1.addEventListener("click", ()=> navigateToStep(1));

const bBack2 = document.getElementById("btnBackToStep2");
if (bBack2) bBack2.addEventListener("click", ()=> navigateToStep(2));

  // Apply URL step
  state.step = [1,2,3].includes(urlStep) ? urlStep : 1;
  setUrl(state.step, state.token);
  renderByStep(state.step);

  // When landing on step 2 or 3, we keep identity token tracking
  if (state.step !== 1){
    const id = loadIdentity();
    if (!id || id.token !== state.token){
      // If student arrives with a token not cached, cache it
      localStorage.setItem("typing_test_identity_v1", JSON.stringify({
        token: state.token,
        firstName: id?.firstName || "",
        lastName: id?.lastName || "",
        studentId: id?.studentId || "",
      }));
    }
  }
  const btnUpload = document.getElementById("btnUploadStep2");
if (btnUpload){
  btnUpload.addEventListener("click", submitStep2File);
}
}

init();
</script>
</body>
</html>
